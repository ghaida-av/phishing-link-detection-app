<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Phishing Link Detection App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; padding: 30px; background: #f6f8fa; }
    h1 { text-align: center; }
    input, button { width: 100%; padding: 10px; margin-top: 15px; border-radius: 8px; }
    input { border: 1px solid #ccc; }
    button { border: none; background: #007BFF; color: white; }
    button:hover { background: #0056b3; cursor: pointer; }
    pre { background: #fff; padding: 15px; border-radius: 8px; margin-top: 20px; overflow-x: auto; }
    ul { background: #fff; border-radius: 8px; padding: 10px; }
  </style>
</head>
<body>
  <h1>hishing Link Detection App</h1>

  <input id="urlInput" placeholder="Enter the URL" />
  <button onclick="checkUrl()">Check</button>

  <button id="copyButton" onclick="copyResult()"> Copy Result</button>
  <button id="shareButton" onclick="shareResult()">ðŸ”— Share Result</button>

  <pre id="result">Result appears here</pre>

  <h3>Recent Checks</h3>
  <ul id="historyList"></ul>

  <script>
    async function checkUrl() {
      const url = document.getElementById("urlInput").value.trim();
      const resultEl = document.getElementById("result");
      const historyEl = document.getElementById("historyList");

      if (!url) {
        resultEl.textContent = "Enter the URL.";
        return;
      }

      resultEl.textContent = "Checking...";
      try {
        const resp = await fetch("http://localhost:5001/predict", {   
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ url })
        });
        const data = await resp.json();
        resultEl.textContent = JSON.stringify(data, null, 2);

        
        let history = JSON.parse(localStorage.getItem("history") || "[]");
        history.unshift({ url, verdict: data.verdict, score: data.score });
        if (history.length > 5) history = history.slice(0, 5);
        localStorage.setItem("history", JSON.stringify(history));

       
        historyEl.innerHTML = history
          .map(h => `<li>${h.url} â€” <b>${h.verdict}</b> (score: ${h.score})</li>`)
          .join("");

      } catch (err) {
        resultEl.textContent = "Error: " + err.message;
      }
    }

   
    window.onload = () => {
      const historyEl = document.getElementById("historyList");
      const history = JSON.parse(localStorage.getItem("history") || "[]");
      historyEl.innerHTML = history
        .map(h => `<li>${h.url} â€” <b>${h.verdict}</b> (score: ${h.score})</li>`)
        .join("");
    };

   
    async function copyResult() {
      const text = document.getElementById("result").textContent.trim();
      if (!text) return alert("No result to copy!");
      await navigator.clipboard.writeText(text);
      alert(" Result copied to clipboard");
    }

    async function shareResult() {
      const text = document.getElementById("result").textContent.trim();
      if (!text) return alert("No result to share!");
      if (navigator.share) {
        await navigator.share({
          title: "hishing Link Detection App Result",
          text: text,
        });
      } else {
        alert("Sharing not supported in this browser.");
      }
    }
  </script>
</body>
</html>
